<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VR Room with Trigger-Controlled Color Change</title>
  <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
</head>
<body>
<a-scene>
  <!-- Camera setup -->
  <a-entity id="cameraRig" position="0 1 0">
    <a-entity id="camera" camera look-controls></a-entity>

    <!-- Left controller -->
    <a-entity
      id="leftHand"
      laser-controls="hand: left"
      oculus-touch-controls="hand: left"
      color-changer="direction: previous">
    </a-entity>

    <!-- Right controller -->
    <a-entity
      id="rightHand"
      laser-controls="hand: right"
      oculus-touch-controls="hand: right"
      color-changer="direction: next">
    </a-entity>
  </a-entity>

  <!-- Room walls -->
  <a-box
    position="0 1.5 -5"
    width="12"
    height="3"
    depth="12"
    color="#2e2e2e"
    material="side: double;">
  </a-box>

  <!-- Whiteboard -->
  <a-plane
    id="whiteboard"
    position="0 2 -4"
    width="4"
    height="2.5"
    color="#ffffff"
    shadow="cast: true">
    <a-light
      type="spot"
      intensity="1.5"
      position="0 3 0"
      angle="60"
      target="#whiteboard"
      color="#fffae6">
    </a-light>
    <a-text
      id="whiteboard-text"
      value="Appuyez sur A/D ou les gÃ¢chettes pour changer la couleur."
      align="center"
      width="3.8"
      position="0 0 0.1"
      color="#000000">
    </a-text>
  </a-plane>

  <!-- Lights -->
  <a-light type="ambient" intensity="0.5" color="#ffffff"></a-light>
  <a-light type="point" intensity="1" color="#ffffff" position="0 3 2" target="#whiteboard"></a-light>

  <!-- Sky -->
  <a-sky color="#87CEEB"></a-sky>

  <!-- Color changer logic -->
  <script>
    AFRAME.registerComponent('color-changer', {
      schema: {
        direction: {type: 'string', default: 'next'}
      },
      init: function () {
        this.colorIndex = 0; // Start with the first color
        this.colors = ['#ffffff', '#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
        this.whiteboard = document.querySelector('#whiteboard');
        this.el.addEventListener('triggerdown', this.changeColor.bind(this));
      },
      changeColor: function () {
        if (this.data.direction === 'next') {
          this.colorIndex = (this.colorIndex + 1) % this.colors.length; // Next color
        } else if (this.data.direction === 'previous') {
          this.colorIndex = (this.colorIndex - 1 + this.colors.length) % this.colors.length; // Previous color
        }
        this.whiteboard.setAttribute('color', this.colors[this.colorIndex]);
      }
    });

    // Keyboard controls for color changing
    document.addEventListener('keydown', function (event) {
      const whiteboard = document.querySelector('#whiteboard');
      const colors = ['#ffffff', '#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
      let colorIndex = colors.indexOf(whiteboard.getAttribute('color'));

      if (event.key === 'd' || event.key === 'D') {
        // Next color
        colorIndex = (colorIndex + 1) % colors.length;
      } else if (event.key === 'a' || event.key === 'A') {
        // Previous color
        colorIndex = (colorIndex - 1 + colors.length) % colors.length;
      }

      // Update the whiteboard color
      whiteboard.setAttribute('color', colors[colorIndex]);
    });
  </script>
</a-scene>
</body>
</html>
